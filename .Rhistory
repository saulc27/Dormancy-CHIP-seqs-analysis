View(SE.only.table.final)
SE.only.table <- read.all.enhacers.table[read.all.enhacers.table$isSuper==1,]
SE.only.table.final <-  SE.only.table[,c(1,2,3,4,10,12,13,14)]
SE.only.table.final$FC  <- (SE.only.table.final$THEP_H3K27ac.XL.final.bam/SE.only.table.final$DHEP_H3K27ac.XL.final.bam)+1
SE.only.table.final$log2FC <- log2(SE.only.table.final$FC)
View(SE.only.table.final)
SE.only.table.final$FC  <- SE.only.table.final$THEP_H3K27ac.XL.final.bam/SE.only.table.final$DHEP_H3K27ac.XL.final.bam
SE.only.table.final$log2FC <- log2(SE.only.table.final$FC)
SE.only.table.final.with.promoters <- merge(read.enhancer.promoter.table, SE.only.table.final, by.x = "V4", by.y="REGION_ID")
View(SE.only.table.final.with.promoters)
diff.enhancers.up.table.with.promoters <- SE.only.table.final.with.promoters[log2FC>1.5,]
diff.enhancers.up.table.with.promoters <- SE.only.table.final.with.promoters["log2FC">1.5,]
View(diff.enhancers.up.table.with.promoters)
diff.enhancers.up.table.with.promoters <- SE.only.table.final.with.promoters[SE.only.table.final.with.promoters$log2FC>1.5,]
View(diff.enhancers.up.table.with.promoters)
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC>-1.5  ,]
View(diff.enhancers.table.with.promoters)
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC<-1.5  ,]
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC<-1.5),]
diff.enhancers.table.with.promoters <-
SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
View(diff.enhancers.table.with.promoters)
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
rm(diff.enhancers.up.table.with.promoters)
View(read.rnaseq.counts)
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters.and.RNAseq, read.rnaseq.counts, by.x="V9", by.y="rn")
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters, read.rnaseq.counts, by.x="V9", by.y="rn")
View(diff.enhancers.table.with.promoters.and.RNAseq)
diff.enhancers.table.with.promoters.and.RNAseq.final  %>%
diff.enhancers.table.with.promoters.and.RNAseq_by(V4) %>%
slice(which.max(log2FoldChange))
final <- diff.enhancers.table.with.promoters.and.RNAseq  %>%
diff.enhancers.table.with.promoters.and.RNAseq_by(V4) %>%
slice(which.max(log2FoldChange))
diff.enhancers.table.with.promoters.and.RNAseq.final <- diff.enhancers.table.with.promoters.and.RNAseq  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.final)
View(read.rnaseq.counts)
mean(read.rnaseq.counts$baseMean)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,6)]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,-6)]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed)
mean(diff.enhancers.table.with.promoters.and.RNAseq.trimmed$baseMean)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed2 <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$baseMean>100,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed2)
diff.enhancers.table.with.promoters.and.RNAseq.final <- ddiff.enhancers.table.with.promoters.and.RNAseq.trimmed2  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
diff.enhancers.table.with.promoters.and.RNAseq.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed2  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.final)
View(read.all.enhacers.table)
View(diff.enhancers.table.with.promoters.and.RNAseq)
View(read.all.enhacers.table)
View(diff.enhancers.table.with.promoters.and.RNAseq.final)
diff.enhancers.table.with.promoters.and.RNAseq.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed2  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$log2FC>0,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$log2FC<0,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed$log2FC<0
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$log2FC< -1,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC< -1,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed2)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down  %>%
group_by(V4) %>%
slice(which.min(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,-6)]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed2 <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$baseMean>500,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC< -1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down  %>%
group_by(V4) %>%
slice(which.min(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down.final)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
args(which.max)
args(top_n)
?top_n
test <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up %>% group_by(Subject) %>% top_n(2, pt)
test <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up %>% group_by(V4) %>% top_n(2, pt)
test <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up %>% group_by(V4) %>% top_n(2, log2FoldChange)
View(test)
test <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up %>% group_by(V4) %>% top_n(1:2, log2FoldChange)
?which.max
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(1:2, log2FoldChange))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange[1:2]))
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange[1:2]))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange[1:2,]))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange[,1:2]))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange, 1:2))
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange)[1:2])
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange)[1:2])
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))[1:2]
args(slice)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.
RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC< -1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:5)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(1, log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(1, log2FoldChange)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))[1:2]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))[1:2]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC< -1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange)[1:4])
test <- c(1,2,3,4,5,6)
which.max(test)
which.max(test[1:2])
which.max(test[2])
which.max(test)
which.max(test, 2)
which.max(test(1:2))
which.max(test
)
which.max(test[1:3]
)
which.max(test[1:6]
)
which.max(test[1:6])
which.max(test)
which.max(test)
which.max(test[c(1,2)])
which.max(test[c(1,2,3)])
which.max(test[,c(1,2,3)])
max(test)
max(test[1:2])
max(test)
?max
>slice
?slice
test %>% top_n(2)
?top_n
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(log2FoldChange, n=2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(wt=log2FoldChange, n=2)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(wt=log2FoldChange, n=2)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(wt=log2FoldChange, n=3)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(wt=log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(wt=log2FoldChange, 1)
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(x=log2FoldChange, n=1, wt = V4 )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(x=log2FoldChange, n=1, wt = "V4" )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(x=log2FoldChange, n=1, wt = V4 )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(x=log2FoldChange, n=1 )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(x=log2FoldChange, n=1 )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(x=V4, n=1 )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(n=1 )
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(n=1, log2FC )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(n=1, log2FC )
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up.final <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters, read.rnaseq.counts, by.x="V9", by.y="rn")
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,-6)]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed2 <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$baseMean>500,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC< -1,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.down)
UP.super.enhancers.with.RNA.seq <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
slice(which.max(log2FoldChange))
View(UP.super.enhancers.with.RNA.seq)
UP.super.enhancers.with.RNA.seq <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(1, log2FoldChange)
View(UP.super.enhancers.with.RNA.seq)
UP.super.enhancers.with.RNA.seq <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
UP.super.enhancers.with.RNA.seq <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
UP.super.enhancers.with.RNA.seq <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(1, log2FoldChange)
UP.super.enhancers.with.RNA.seq <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(4, log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(1, log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
arrange(desc(log2FoldChange)) %>%
group_by(V4) %>% slice(1:2)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
arrange(desc(log2FoldChange)) %>%
group_by(V4) %>% slice(1:3)
test <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
arrange(desc(log2FoldChange)) %>%
group_by(V4) %>% slice(1:3)
View(test)
test <- diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up  %>%
arrange(desc(log2FoldChange)) %>%
group_by(V4) %>% slice(1:2)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed2[diff.enhancers.table.with.promoters.and.RNAseq.trimmed2$log2FC>1,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed.up)
SE.only.table.final.with.promoters <- merge(read.enhancer.promoter.table, SE.only.table.final, by.x = "V4", by.y="REGION_ID")
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters, read.rnaseq.counts, by.x="V9", by.y="rn")
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,-6)]
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters, read.rnaseq.counts, by.x="V9", by.y="rn")
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,-6)]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed)
diff.enhancers.table.with.promoters.and.RNAseq.trimmed2 <-diff.enhancers.table.with.promoters.and.RNAseq.trimmed[diff.enhancers.table.with.promoters.and.RNAseq.trimmed$baseMean>500,]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed2)
SE.only.table <- read.all.enhacers.table[read.all.enhacers.table$isSuper==1,]
SE.only.table.final <-  SE.only.table[,c(1,2,3,4,10,12,13,14)]
SE.only.table.final$FC  <- SE.only.table.final$THEP_H3K27ac.XL.final.bam/SE.only.table.final$DHEP_H3K27ac.XL.final.bam
SE.only.table.final$log2FC <- log2(SE.only.table.final$FC)
SE.only.table.final.with.promoters <- merge(read.enhancer.promoter.table, SE.only.table.final, by.x = "V4", by.y="REGION_ID")
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters, read.rnaseq.counts, by.x="V9", by.y="rn")
diff.enhancers.table.with.promoters.and.RNAseq.trimmed <- diff.enhancers.table.with.promoters.and.RNAseq[,c(-3,-4,-5,-6)]
View(diff.enhancers.table.with.promoters.and.RNAseq.trimmed)
diff.enhancers.table.with.promoters <- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
diff.enhancers.table.with.promoters.and.RNAseq <- merge(diff.enhancers.table.with.promoters, read.rnaseq.counts, by.x="V9", by.y="rn")
View(diff.enhancers.table.with.promoters.and.RNAseq)
View(SE.only.table)
SE.table.with.promoters.final<- SE.only.table.final.with.promoters[which(SE.only.table.final.with.promoters$log2FC>1.5 | SE.only.table.final.with.promoters$log2FC< -1.5),]
View(SE.only.table.final.with.promoters)
View(SE.only.table.final.with.promoters)
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
library(DESeq2)
library(ggplot2)
library(pheatmap)
library(pathfindR)
library(data.table)
library(dplyr)
library(fgsea)
library(tidyverse)
library(clusterProfiler)
library(plyr)
library(magrittr)
library(RColorBrewer)
library(DESeq)
library(gghighlight)
library(superheat)
library(ggpubr)
library(glimma)
library(ggiraph)
library(shiny)
library(DESeq2)
library(ggplot2)
library(pheatmap)
library(pathfindR)
library(data.table)
library(dplyr)
library(fgsea)
library(tidyverse)
library(clusterProfiler)
library(plyr)
library(magrittr)
library(RColorBrewer)
library(DESeq)
library(gghighlight)
library(superheat)
library(ggpubr)
library(glimma)
library(ggiraph)
library(shiny)
setwd(dir = "../../Documents/School/BernsteinLab/Genomics/Chipseq/Dhep Thep/beds/Analysis")
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
View(read.promoter.counts)
View(read.promoter.counts)
View(read.promoter.counts)
read.rnaseq.counts <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
View(read.rnaseq.counts)
read.rnaseq.results <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
rm(read.rnaseq.counts)
View(read.rnaseq.results)
read.all.enhacers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)
View(read.all.enhacers.table)
read.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
View(read.enhancer.promoter.table)
all.enhancers.table.final <- read.all.enhacers.table[,c(1,2,3,4,10,12,13,14)]
View(all.enhancers.table.final)
SE.only.table <- read.all.enhacers.table[read.all.enhacers.table$isSuper==1,]
SE.only.table <- read.all.enhacers.table[all.enhancers.table.final$isSuper==1,]
View(SE.only.table)
SE.only.table <- all.enhancers.table.final[all.enhancers.table.final$isSuper==1,]
View(SE.only.table)
SE.only.table.final$FC  <- SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam
SE.only.table$FC  <- SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam
SE.only.table$log2FC <- log2(SE.only.table$FC)
View(SE.only.table)
SE.only.table.final.with.promoters <- merge(read.enhancer.promoter.table, SE.only.table, by.x = "V4", by.y="REGION_ID")
View(SE.only.table)
View(SE.only.table.final.with.promoters)
View(SE.only.table)
View(read.enhancer.promoter.table)
SE.only.table.final.with.promoters.final <- SE.only.table.final.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
View(SE.only.table.final.with.promoters.final)
View(read.enhancer.promoter.table)
SE.Promoters.Diff.nodup <- SE.only.table.final.with.promoters.final[!duplicated(SE.only.table.final.with.promoters.final),]
View(SE.Promoters.Diff.nodup)
SE.table.with.promoters.only.DF <- SE.Promoters.Diff.nodup[which(SE.Promoters.Diff.nodup$log2FC>1.5 | SE.Promoters.Diff.nodup$log2FC< -1.5),]
View(SE.table.with.promoters.only.DF)
SE.table.promoters.RNA.seq<- merge(SE.table.with.promoters.only.DF, read.rnaseq.results, by.x="V9", by.y="rn")
View(SE.table.promoters.RNA.seq)
View(SE.only.table)
SE.only.table.DF <- SE.only.table[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
View(SE.only.table.DF)
SE.table.promoters.RNA.seq.filtered <-SE.table.promoters.RNA.seq[SE.table.promoters.RNA.seq$baseMean>500,]
View(SE.table.promoters.RNA.seq.filtered)
SE.table.promoters.RNA.seq.THEP <- SE.table.promoters.RNA.seq.filtered[SE.table.promoters.RNA.seq.filtered$log2FC>1,]
View(SE.table.promoters.RNA.seq.THEP)
SE.table.promoters.RNA.seq.DHEP <-SE.table.promoters.RNA.seq.filtered[SE.table.promoters.RNA.seq.filtered$log2FC< -1,]
View(SE.table.promoters.RNA.seq.THEP)
View(SE.table.with.promoters.only.DF)
View(SE.table.promoters.RNA.seq.THEP)
View(SE.table.promoters.RNA.seq.filtered)
View(SE.table.promoters.RNA.seq.DHEP)
SE.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
View(SE.table.promoters.RNA.seq.THEP.top)
SE.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
View(final.table.promoters.RNA.seq.THEP.top)
View(final.table.promoters.RNA.seq.DHEP.top)
library(DESeq2)
library(ggplot2)
library(pheatmap)
library(pathfindR)
library(data.table)
library(dplyr)
library(fgsea)
library(tidyverse)
library(clusterProfiler)
library(plyr)
library(magrittr)
library(RColorBrewer)
library(DESeq)
library(gghighlight)
library(superheat)
library(ggpubr)
library(glimma)
library(ggiraph)
library(shiny)
setwd(dir = "../../Documents/School/BernsteinLab/Genomics/Chipseq/Dhep Thep/beds/Analysis")
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
View(read.promoter.counts)
read.rnaseq.results <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
read.all.enhacers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)
View(read.all.enhacers.table)
read.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
View(read.enhancer.promoter.table)
all.enhancers.table.final <- read.all.enhacers.table[,c(1,2,3,4,10,12,13,14)]
SE.only.table <- all.enhancers.table.final[all.enhancers.table.final$isSuper==1,]
SE.only.table$FC  <- SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam
SE.only.table$log2FC <- log2(SE.only.table$FC)
SE.only.table.DF <- SE.only.table[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
SE.only.table.final.with.promoters <- merge(read.enhancer.promoter.table, SE.only.table, by.x = "V4", by.y="REGION_ID")
SE.only.table.final.with.promoters.final <- SE.only.table.final.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
SE.Promoters.Diff.nodup <- SE.only.table.final.with.promoters.final[!duplicated(SE.only.table.final.with.promoters.final),]
SE.table.with.promoters.only.DF <- SE.Promoters.Diff.nodup[which(SE.Promoters.Diff.nodup$log2FC>1.5 | SE.Promoters.Diff.nodup$log2FC< -1.5),]
SE.table.promoters.RNA.seq<- merge(SE.table.with.promoters.only.DF, read.rnaseq.results, by.x="V9", by.y="rn")
SE.table.promoters.RNA.seq.filtered <-SE.table.promoters.RNA.seq[SE.table.promoters.RNA.seq$baseMean>500,]
SE.table.promoters.RNA.seq.THEP <- SE.table.promoters.RNA.seq.filtered[SE.table.promoters.RNA.seq.filtered$log2FC>1,]
SE.table.promoters.RNA.seq.DHEP <-SE.table.promoters.RNA.seq.filtered[SE.table.promoters.RNA.seq.filtered$log2FC< -1,]
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
View(final.table.promoters.RNA.seq.DHEP.top)
View(final.table.promoters.RNA.seq.THEP.top)
View(SE.Promoters.Diff.nodup)
View(SE.table.with.promoters.only.DF)
View(SE.table.promoters.RNA.seq.filtered)
view(SE.table.promoters.RNA.seq.THEP)
view(SE.table.promoters.RNA.seq.DHEP)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
top_n(-2, log2FoldChange)
View(final.table.promoters.RNA.seq.THEP.top)
View(final.table.promoters.RNA.seq.DHEP.top)
