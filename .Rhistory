final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
top_n(-2, log2FoldChange)
View(final.table.promoters.RNA.seq.THEP.top)
View(final.table.promoters.RNA.seq.DHEP.top)
setwd(dir = "../../Documents/School/BernsteinLab/Genomics/Chipseq/Dhep Thep/beds/Analysis")
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
View(read.promoter.counts)
read.rnaseq.results <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
read.all.enhacers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)
View(read.all.enhacers.table)
View(read.promoter.counts)
View(read.rnaseq.results)
View(read.promoter.counts)
read.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
read.1mb.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
read.2mb.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-2mb-extended-with-promoters.bed", header = F)
rm(read.enhancer.promoter.table)
all.enhancers.table.final <- read.all.enhacers.table[,c(1,2,3,4,10,12,13,14)]
View(all.enhancers.table.final)
trimmed.all.enhancers.table <- read.all.enhacers.table[,c(1,2,3,4,10,12,13,14)]
View(all.enhancers.table.final)
View(trimmed.all.enhancers.table)
View(all.enhancers.table.final)
View(trimmed.all.enhancers.table)
View(all.enhancers.table.final)
read.all.enhacers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)
View(read.all.enhacers.table)
read.all.enhacers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)[,c(1,2,3,4,10,12,13,14)]
View(read.all.enhacers.table)
all.enhacers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)[,c(1,2,3,4,10,12,13,14)]
View(all.enhacers.table)
View(all.enhancers.table.final)
rm(all.enhancers.table.final)
all.enhancers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)[,c(1,2,3,4,10,12,13,14)]
rm(all.enhacers.table)
rm(trimmed.all.enhancers.table)
View(read.all.enhacers.table)
rm(read.all.enhacers.table)
SE.only.table <- all.enhancers.table.final[all.enhancers.table.final$isSuper==1,]
b
SE.only.table <- enhancers.table.final[enhancers.table.final$isSuper==1,]
SE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==1,]
View(SE.only.table)
SE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==1,]
SE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==1,]
SE.only.table$FC  <- SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam
SE.only.table$log2FC <- log2(SE.only.table$FC)
View(SE.only.table)
SE.only.table$log2FC <- log2(SE.only.table$FC)[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
SE.only.table$log2FC <- log2(SE.only.table$FC) %>% [which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
SE.only.table$log2FC <- log2(SE.only.table$FC)[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
SE.only.table$FC  <- log2(SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam)
SE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==1,]
SE.only.table$log2FC  <- log2(SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam)
View(SE.only.table)
SE.only.table[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
SE.only.table.DF <- SE.only.table[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
#TE only with Log2FC
TE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==2,]
TE.only.table$log2FC  <- log2(TE.only.table$THEP_H3K27ac.XL.final.bam/TE.only.table$DHEP_H3K27ac.XL.final.bam)
TE.only.table.DF <- TE.only.table[which(TE.only.table$log2FC>1.5 | TE.only.table$log2FC< -1.5),]
#TE only with Log2FC
TE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==0,]
TE.only.table$log2FC  <- log2(TE.only.table$THEP_H3K27ac.XL.final.bam/TE.only.table$DHEP_H3K27ac.XL.final.bam)
TE.only.table.DF <- TE.only.table[which(TE.only.table$log2FC>1.5 | TE.only.table$log2FC< -1.5),]
View(TE.only.table.DF)
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table, by.x = "V4", by.y="REGION_ID")
View(SE.only.with.promoters)
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")
View(SE.only.with.promoters)
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")
View(TE.only.table.DF)
View(TE.only.table.DF)
View(SE.only.with.promoters)
SE.only.table.final.with.promoters.final <- SE.only.table.final.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
SE.only.table.final.with.promoters.final <- SE.only.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
View(SE.only.table.final.with.promoters.final)
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated(SE.only.table.final.with.promoters.final),]
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated,]
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated(SE.only.with.promoters),]
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")#[!duplicated(SE.only.with.promoters),]
Trimmed.SE.only.with.promoters <- SE.only.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
rm(SE.only.table.final.with.promoters.final)
View(Trimmed.SE.only.with.promoters)
#merging with RNAseq table
SE.table.promoters.RNA.seq<- merge(Trimmed.SE.only.with.promoters , read.rnaseq.results, by.x="V9", by.y="rn")
#merging with RNAseq table
RNA.seq.SE.table.promoters<- merge(Trimmed.SE.only.with.promoters , read.rnaseq.results, by.x="V9", by.y="rn")
View(RNA.seq.SE.table.promoters)
mean(RNA.seq.SE.table.promoters$baseMean)
summary(RNA.seq.SE.table.promoters$baseMean)
RNA.seq.SE.table.promoters.filtered<- RNA.seq.SE.table.promoters[SRNA.seq.SE.table.promoters$baseMean>500,]
RNA.seq.SE.table.promoters.filtered<- RNA.seq.SE.table.promoters[RNA.seq.SE.table.promoters$baseMean>500,]
View(RNA.seq.SE.table.promoters.filtered)
test1 <- RNA.seq.SE.table.promoters.filtered %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
library(dplyr)
test1 <- RNA.seq.SE.table.promoters.filtered %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
View(test1)
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[SE.table.promoters.RNA.seq.filtered$log2FC>1,]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[SE.table.promoters.RNA.seq.filtered$log2FC< -1,]
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC>1,]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC< -1,]
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
View(final.table.promoters.RNA.seq.THEP.top)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
top_n(-2, log2FoldChange)
View(final.table.promoters.RNA.seq.THEP.top)
#merging with RNAseq table and filtering lower expressed genes
RNA.seq.SE.table.promoters<- merge(Trimmed.SE.only.with.promoters , read.rnaseq.results, by.x="V9", by.y="rn")
RNA.seq.SE.table.promoters.filtered<- RNA.seq.SE.table.promoters[RNA.seq.SE.table.promoters$baseMean>500,]
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC>1,]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC< -1,]
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC>1,] [!duplicated(SE.table.promoters.RNA.seq.THEP),]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC< -1,] [!duplicated(SE.table.promoters.RNA.seq.DHEP),]
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
top_n(2, log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
slice(1:2)
View(final.table.promoters.RNA.seq.THEP.top)
final.table.promoters.RNA.seq.THEP.top2 <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
slice(1:2)
View(final.table.promoters.RNA.seq.THEP.top2)
View(final.table.promoters.RNA.seq.THEP.top)
final.table.promoters.RNA.seq.THEP.top2 <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
slice(1)
summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
slice(2)
summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
slice(3)
summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(3)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1)
summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(2)
summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(3)
summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1)
sumaries <- summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(2)
sumaries$summary2 <- summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
View(sumaries)
summary1 <- as.data.frame(summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange))
summary1 <- as.table(summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange))
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(2)
summary1$summary2 <- as.table(summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange))
summary1 <- summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
View(sumaries)
summary1 <- summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(2)
summary2 <- summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(3)
summary3 <- summary(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
meantable <- (final.table.promoters.RNA.seq.DHEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(2)
meantable <- cbind(final.table.promoters.RNA.seq.DHEP.top$log2FoldChange)
View(meantable)
meantable <- (mean(final.table.promoters.RNA.seq.DHEP.top$log2FoldChange)
)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1)
meantable <- mean(final.table.promoters.RNA.seq.DHEP.top$log2FoldChange)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(2)
meantable <- cbind(mean(final.table.promoters.RNA.seq.DHEP.top$log2FoldChange))
View(meantable)
meantable$mean2 <- cbind(mean(final.table.promoters.RNA.seq.DHEP.top$log2FoldChange))
meantable <- rbind(mean(final.table.promoters.RNA.seq.DHEP.top$log2FoldChange))
View(meantable)
summaries <-c(summary1, summary2, summary3)
View(sumaries)
rm(summaries)
library(dplyr)
#active promoters
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
#RNAseq table
read.rnaseq.results <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
#ROSe enhancer table
all.enhancers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)[,c(1,2,3,4,10,12,13,14)]
#Enhancer promoter tables (bedtools)
read.1mb.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
#SE only with Log2Fc cutoff
SE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==1,]
SE.only.table$log2FC  <- log2(SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam)
SE.only.table.DF <- SE.only.table[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
#TE only with Log2FC
TE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==0,]
TE.only.table$log2FC  <- log2(TE.only.table$THEP_H3K27ac.XL.final.bam/TE.only.table$DHEP_H3K27ac.XL.final.bam)
TE.only.table.DF <- TE.only.table[which(TE.only.table$log2FC>1.5 | TE.only.table$log2FC< -1.5),]
#Merging DF enhancer table with promoters removing dups
SE.only.with.promoters <- merge(read.2mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated(SE.only.with.promoters),]
Trimmed.SE.only.with.promoters <- SE.only.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
#Merging DF enhancer table with promoters removing dups
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated(SE.only.with.promoters),]
#Merging DF enhancer table with promoters removing dups
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated(SE.only.with.promoters),]
#Merging DF enhancer table with promoters removing dups
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")[!duplicated(SE.only.with.promoters),]
#Merging DF enhancer table with promoters removing dups
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")#[!duplicated(SE.only.with.promoters),]
SE.only.with.promoters <- SE.only.with.promoters[!duplicated(SE.only.with.promoters),]
Trimmed.SE.only.with.promoters <- SE.only.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
View(Trimmed.SE.only.with.promoters)
#merging with RNAseq table and filtering lower expressed genes
RNA.seq.SE.table.promoters<- merge(Trimmed.SE.only.with.promoters , read.rnaseq.results, by.x="V9", by.y="rn")
RNA.seq.SE.table.promoters.filtered<- RNA.seq.SE.table.promoters[RNA.seq.SE.table.promoters$baseMean>500,]
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC>1,] [!duplicated(SE.table.promoters.RNA.seq.THEP),]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC< -1,] [!duplicated(SE.table.promoters.RNA.seq.DHEP),]
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC>1,]
SE.table.promoters.RNA.seq.THEP <- SE.table.promoters.RNA.seq.THEP[!duplicated(SE.table.promoters.RNA.seq.THEP),]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC< -1,]
SE.table.promoters.RNA.seq.DHEP <- SE.table.promoters.RNA.seq.DHEP[!duplicated(SE.table.promoters.RNA.seq.DHEP),]
View(SE.table.promoters.RNA.seq.THEP)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1)
plot(as.numeric(final.table.promoters.RNA.seq.THEP.top$log2FC),final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
plot(as.numeric(final.table.promoters.RNA.seq.THEP.top$log2FC),SE.table.promoters.RNA.seq.THEP$log2FoldChange)
plot(as.numeric(SE.table.promoters.RNA.seq.THEP$log2FC),SE.table.promoters.RNA.seq.THEP$log2FoldChange)
ggscatterstats(
data = log2(final.table.promoters.RNA.seq.THEP.top),
x = 10,
y = 13,
xlab = "Log2 Counts THEP3 H3K27ac",
ylab = "Log2 Counts DHEP3 H3K27ac",
title = "H3K27ac CHIP-seq counts between DHEP3 and THEP3",
point.size = 1, point.alpha = 1, line.size =0.5,
bf.message = FALSE,
messages = FALSE,
marginal = TRUE,
method = "lm",
results.subtitle = TRUE
)
library(ggstatsplot)
ggscatterstats(
data = log2(final.table.promoters.RNA.seq.THEP.top),
x = 10,
y = 13,
xlab = "Log2 Counts THEP3 H3K27ac",
ylab = "Log2 Counts DHEP3 H3K27ac",
title = "H3K27ac CHIP-seq counts between DHEP3 and THEP3",
point.size = 1, point.alpha = 1, line.size =0.5,
bf.message = FALSE,
messages = FALSE,
marginal = TRUE,
method = "lm",
results.subtitle = TRUE
)
class(final.table.promoters.RNA.seq.THEP.top)
class(final.table.promoters.RNA.seq.THEP.top$log2FC)
class(final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
ggscatterstats(
data = final.table.promoters.RNA.seq.THEP.top,
x = 10,
y = 13,
xlab = "Log2 Counts THEP3 H3K27ac",
ylab = "Log2 Counts DHEP3 H3K27ac",
title = "H3K27ac CHIP-seq counts between DHEP3 and THEP3",
point.size = 1, point.alpha = 1, line.size =0.5,
bf.message = FALSE,
messages = FALSE,
marginal = TRUE,
method = "lm",
results.subtitle = TRUE
)
ggscatterstats(
data = final.table.promoters.RNA.seq.THEP.top,
x = 13,
y = 10,
xlab = "Log2 Counts THEP3 H3K27ac",
ylab = "Log2 Counts DHEP3 H3K27ac",
title = "H3K27ac CHIP-seq counts between DHEP3 and THEP3",
point.size = 1, point.alpha = 1, line.size =0.5,
bf.message = FALSE,
messages = FALSE,
marginal = TRUE,
method = "lm",
results.subtitle = TRUE
)
ggscatterstats(
data = final.table.promoters.RNA.seq.THEP.top,
x = 10,
y = 12,
xlab = "Log2 Counts THEP3 H3K27ac",
ylab = "Log2 Counts DHEP3 H3K27ac",
title = "H3K27ac CHIP-seq counts between DHEP3 and THEP3",
point.size = 1, point.alpha = 1, line.size =0.5,
bf.message = FALSE,
messages = FALSE,
marginal = TRUE,
method = "lm",
results.subtitle = TRUE
)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
arrange(asc(log2FoldChange)) %>%
slice(1)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1)
View(final.table.promoters.RNA.seq.THEP.top)
View(final.table.promoters.RNA.seq.DHEP.top)
View(final.table.promoters.RNA.seq.DHEP.top)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1:2)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1)
View(final.table.promoters.RNA.seq.THEP.top)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
View(final.table.promoters.RNA.seq.DHEP.top)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
final.table.promoters.RNA.seq.DHEP.top <- SE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1:2)
View(final.table.promoters.RNA.seq.DHEP.top)
#Merging DF TE enhancer table with promoters removing dups
TE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, TE.only.table.DF, by.x = "V4", by.y="REGION_ID")
TE.only.with.promoters <- TE.only.with.promoters[!duplicated(TE.only.with.promoters),]
Trimmed.TE.only.with.promoters <- TE.only.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
View(Trimmed.TE.only.with.promoters)
View(TE.only.with.promoters)
#TE only with Log2FC
TE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==0,]
TE.only.table$log2FC  <- log2(TE.only.table$THEP_H3K27ac.XL.final.bam/TE.only.table$DHEP_H3K27ac.XL.final.bam)
View(TE.only.table.DF)
View(TE.only.table)
View(TE.only.with.promoters)
#merging with RNAseq table and filtering lower expressed genes
RNA.seq.TE.table.promoters<- merge(Trimmed.TE.only.with.promoters , read.rnaseq.results, by.x="V9", by.y="rn")
RNA.seq.TE.table.promoters.filtered<- RNA.seq.TE.table.promoters[RNA.seq.TE.table.promoters$baseMean>500,]
View(RNA.seq.TE.table.promoters.filtered)
RNA.seq.TE.table.promoters.filtered<- RNA.seq.TE.table.promoters[RNA.seq.TE.table.promoters$baseMean>250,]
TE.table.promoters.RNA.seq.THEP <- RNA.seq.TE.table.promoters.filtered[RNA.seq.TE.table.promoters.filtered$log2FC>1,]
TE.table.promoters.RNA.seq.THEP <- TE.table.promoters.RNA.seq.THEP[!duplicated(TE.table.promoters.RNA.seq.THEP),]
TE.table.promoters.RNA.seq.DHEP <-RNA.seq.TE.table.promoters.filtered[RNA.seq.TE.table.promoters.filtered$log2FC< -1,]
TE.table.promoters.RNA.seq.DHEP <- TE.table.promoters.RNA.seq.DHEP[!duplicated(TE.table.promoters.RNA.seq.DHEP),]
View(TE.table.promoters.RNA.seq.THEP)
TE.final.table.promoters.RNA.seq.THEP.top <- TE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1)
View(TE.final.table.promoters.RNA.seq.THEP.top)
summary(TE.final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
hist(TE.final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
TE.final.table.promoters.RNA.seq.DHEP.top <- TE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1)
hist(TE.final.table.promoters.RNA.seq.DHEP.top$log2FoldChange)
summary(TE.final.table.promoters.RNA.seq.DHEP.top$log2FoldChange)
TE.final.table.promoters.RNA.seq.THEP.top <- TE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
#arrange(desc(log2FoldChange)) %>%
arrange(log2FoldChange) %>%
slice(1)
hist(TE.final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
summary(TE.final.table.promoters.RNA.seq.THEP.top$log2FoldChange)
View(TE.final.table.promoters.RNA.seq.THEP.top)
TE.final.table.promoters.RNA.seq.THEP.top <- TE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1)
View(SE.table.promoters.RNA.seq.THEP)
View(TE.final.table.promoters.RNA.seq.THEP.top)
ggscatterstats(
data = TE.final.table.promoters.RNA.seq.DHEP.top,
x = 10,
y = 13,
xlab = "Log2 Counts THEP3 H3K27ac",
ylab = "Log2 Counts DHEP3 H3K27ac",
title = "H3K27ac CHIP-seq counts between DHEP3 and THEP3",
point.size = 1, point.alpha = 1, line.size =0.5,
bf.message = FALSE,
messages = FALSE,
marginal = TRUE,
method = "lm",
results.subtitle = TRUE
)
TE.final.table.promoters.RNA.seq.THEP.top <- TE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1)
TE.final.table.promoters.RNA.seq.DHEP.top <- TE.table.promoters.RNA.seq.DHEP  %>%
group_by(V4) %>%
arrange(log2FoldChange) %>%
slice(1)
View(TE.final.table.promoters.RNA.seq.THEP.top)
View(TE.final.table.promoters.RNA.seq.DHEP.top)
View(final.table.promoters.RNA.seq.DHEP.top)
View(read.rnaseq.results)
View(read.1mb.enhancer.promoter.table)
library(dplyr)
#active promoters
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
View(read.promoter.counts)
#RNAseq table
read.rnaseq.results <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
#ROSe enhancer table
all.enhancers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)[,c(1,2,3,4,10,12,13,14)]
View(all.enhancers.table)
#Enhancer promoter tables (bedtools)
read.1mb.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
View(all.enhancers.table)
View(read.1mb.enhancer.promoter.table)
read.2mb.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-2mb-extended-with-promoters.bed", header = F)
#SE only with Log2Fc cutoff
SE.only.table <- all.enhancers.table[all.enhancers.table$isSuper==1,]
SE.only.table$log2FC  <- log2(SE.only.table$THEP_H3K27ac.XL.final.bam/SE.only.table$DHEP_H3K27ac.XL.final.bam)
SE.only.table.DF <- SE.only.table[which(SE.only.table$log2FC>1.5 | SE.only.table$log2FC< -1.5),]
View(SE.only.table.DF)
#Merging DF SE enhancer table with promoters removing dups
SE.only.with.promoters <- merge(read.1mb.enhancer.promoter.table, SE.only.table.DF, by.x = "V4", by.y="REGION_ID")
SE.only.with.promoters <- SE.only.with.promoters[!duplicated(SE.only.with.promoters),]
Trimmed.SE.only.with.promoters <- SE.only.with.promoters[,c(-2,-3,-4,-5,-6,-7,-8)]
#merging with RNAseq table and filtering lower expressed genes
RNA.seq.SE.table.promoters<- merge(Trimmed.SE.only.with.promoters , read.rnaseq.results, by.x="V9", by.y="rn")
RNA.seq.SE.table.promoters.filtered<- RNA.seq.SE.table.promoters[RNA.seq.SE.table.promoters$baseMean>500,]
SE.table.promoters.RNA.seq.THEP <- RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC>1,]
SE.table.promoters.RNA.seq.THEP <- SE.table.promoters.RNA.seq.THEP[!duplicated(SE.table.promoters.RNA.seq.THEP),]
SE.table.promoters.RNA.seq.DHEP <-RNA.seq.SE.table.promoters.filtered[RNA.seq.SE.table.promoters.filtered$log2FC< -1,]
SE.table.promoters.RNA.seq.DHEP <- SE.table.promoters.RNA.seq.DHEP[!duplicated(SE.table.promoters.RNA.seq.DHEP),]
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
View(final.table.promoters.RNA.seq.THEP.top)
final.table.promoters.RNA.seq.THEP.top <- SE.table.promoters.RNA.seq.THEP  %>%
group_by(V4) %>%
arrange(desc(log2FoldChange)) %>%
slice(1:2)
View(final.table.promoters.RNA.seq.THEP.top)
setwd(dir = "../../Documents/School/BernsteinLab/Genomics/Chipseq/Dhep Thep/beds/Analysis")
#active promoters
read.promoter.counts <- read.table(file = "../Promoters-with-DHEP3-THEP3-H3K27ac-and-BM-NR2F1-counts.csv", sep = ",", header = TRUE)
#RNAseq table
read.rnaseq.results <- read.table(file = "../DvT.RNAseq.results.csv", sep = ",", header = TRUE)
#ROSe enhancer table
all.enhancers.table <- read.table(file = "../DHEP-THEP-H3K27ac-merged-q1e-3_filtered_AllEnhancers.table.txt", header = TRUE)[,c(1,2,3,4,10,12,13,14)]
#Enhancer promoter tables (bedtools)
read.1mb.enhancer.promoter.table <- read.table(file ="DHEP-THEP-H3K27ac-merged-q1e-3_filtered_Enhancers_withSuper-1mb-extended-with-promoters.bed", header = F)
